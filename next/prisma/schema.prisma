// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
  
}

datasource db {
  provider = "postgresql"
}

enum Role {
  SUPER_ADMIN
  ADMIN
  OPERATOR
}

enum LeadStatus {
  NEW
  CONTACTED
  QUALIFIED
  CONVERTED
  LOST
}

model Contact {
  id           String        @id @default(cuid())
  name         String
  email        String?
  phone        String?
  message      String
  status       LeadStatus    @default(NEW)
  assignedToId String?       @map("assigned_to_id")
  assignedTo   Admin?        @relation(fields: [assignedToId], references: [id], onDelete: SetNull)
  notes        ContactNote[]
  createdAt    DateTime      @default(now()) @map("created_at")
  updatedAt    DateTime      @updatedAt @map("updated_at")

  @@map("contacts")
}

model Admin {
  id            String         @id @default(cuid())
  email         String         @unique
  password      String
  name          String
  role          Role           @default(ADMIN)
  assignedLeads Contact[]
  blogPosts     BlogPost[]
  notes         ContactNote[]
  clockRecords  ClockRecord[]
  createdAt     DateTime       @default(now()) @map("created_at")
  updatedAt     DateTime       @updatedAt @map("updated_at")

  @@map("admins")
}

model BlogPost {
  id        String   @id @default(cuid())
  slug      String   @unique
  published Boolean  @default(false)

  // English (primary)
  titleEn       String  @map("title_en")
  excerptEn     String  @map("excerpt_en")
  contentEn     String  @map("content_en")
  metaTitleEn   String? @map("meta_title_en")
  metaDescEn    String? @map("meta_desc_en")
  keywordsEn    String? @map("keywords_en")

  // French
  titleFr       String? @map("title_fr")
  excerptFr     String? @map("excerpt_fr")
  contentFr     String? @map("content_fr")
  metaTitleFr   String? @map("meta_title_fr")
  metaDescFr    String? @map("meta_desc_fr")
  keywordsFr    String? @map("keywords_fr")

  // Arabic
  titleAr       String? @map("title_ar")
  excerptAr     String? @map("excerpt_ar")
  contentAr     String? @map("content_ar")
  metaTitleAr   String? @map("meta_title_ar")
  metaDescAr    String? @map("meta_desc_ar")
  keywordsAr    String? @map("keywords_ar")

  coverImage String? @map("cover_image")

  authorId  String   @map("author_id")
  author    Admin    @relation(fields: [authorId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@map("blog_posts")
}

model ContactNote {
  id        String   @id @default(cuid())
  content   String
  contactId String   @map("contact_id")
  contact   Contact  @relation(fields: [contactId], references: [id], onDelete: Cascade)
  authorId  String   @map("author_id")
  author    Admin    @relation(fields: [authorId], references: [id], onDelete: Cascade)
  createdAt DateTime @default(now()) @map("created_at")

  @@map("contact_notes")
}

model ClockRecord {
  id         String    @id @default(cuid())
  adminId    String    @map("admin_id")
  admin      Admin     @relation(fields: [adminId], references: [id], onDelete: Cascade)
  clockIn    DateTime  @map("clock_in")
  clockOut   DateTime? @map("clock_out")
  durationMs Int?      @map("duration_ms")
  latitudeIn  Float?   @map("latitude_in")
  longitudeIn Float?   @map("longitude_in")
  latitudeOut  Float?  @map("latitude_out")
  longitudeOut Float?  @map("longitude_out")
  createdAt  DateTime  @default(now()) @map("created_at")

  @@map("clock_records")
}
